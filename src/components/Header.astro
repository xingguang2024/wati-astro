---
/**
 * Header Component - Astra AI Agent
 *
 * Based on header-astra_aiagent.php from WordPress
 * Features:
 * - Fixed positioning with scroll effect
 * - Responsive navigation
 * - Hamburger menu for mobile
 * - Multiple CTA buttons
 */

interface Props {
  class?: string;
}

const { class: className } = Astro.props;
---

<header id="masthead" class:list={['site-header', className]}>
  <div class="top-navigation">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between py-5">
        <!-- Logo -->
        <div class="shrink-0">
          <a href="/products/astra/">
            <img
              src="/images/astra-logo.webp"
              alt="Astra AI Agent Logo"
              height="32"
              class="h-8"
            />
          </a>
        </div>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center gap-8">
          <ul class="flex items-center gap-6 m-0 p-0 list-none">
            <li class="astra-pricing-menu-link">
              <a
                href="/products/astra/pricing/"
                class="font-['DM_Sans'] font-medium text-base leading-6 text-zinc-900 hover:font-bold transition-all relative after:content-[attr(data-text)] after:font-bold after:h-0 after:overflow-hidden after:invisible after:block"
                data-text="Pricing"
              >
                Pricing
              </a>
            </li>
            <li>
              <a href="https://www.wati.io/">
                <img
                  width="70"
                  height="25"
                  alt="Wati Logo"
                  src="/images/wati-logo.png"
                  class="h-6"
                />
              </a>
            </li>
          </ul>
        </nav>

        <!-- Desktop CTA Buttons -->
        <div class="hidden md:flex items-center gap-3">
          <button
            id="astraBookDemoBtn"
            class="header-cta-btn font-['DM_Sans'] font-semibold text-sm leading-5 text-zinc-900 border border-zinc-300 px-4 py-2 rounded-lg hover:bg-[#1A3478] hover:text-white hover:border-[#1A3478] transition-all duration-300"
          >
            Book a demo
          </button>

          <a
            href="https://astra.wati.io/register/"
            target="_blank"
            rel="noopener"
            class="header-cta-btn font-['DM_Sans'] font-semibold text-sm leading-5 text-zinc-900 border border-zinc-300 px-4 py-2 rounded-lg hover:bg-[#1A3478] hover:text-white hover:border-[#1A3478] transition-all duration-300"
          >
            Get started for free
          </a>

          <a
            href="https://astra.wati.io/register/"
            target="_blank"
            rel="noopener"
            class="header-cta-btn font-['DM_Sans'] font-semibold text-sm leading-5 text-zinc-900 border border-zinc-300 px-4 py-2 rounded-lg hover:bg-[#1A3478] hover:text-white hover:border-[#1A3478] transition-all duration-300 border-l-2 pl-4 ml-2"
          >
            Login / Sign up
          </a>
        </div>

        <!-- Mobile Hamburger Button -->
        <button
          class="hamburger md:hidden bg-transparent border-0 cursor-pointer p-2 z-10001 relative"
          id="mobileMenuToggle"
          aria-label="Toggle menu"
        >
          <span class="block w-[26px] h-[3px] bg-black my-1 transition-transform duration-400"></span>
          <span class="block w-[26px] h-[3px] bg-black my-1 transition-opacity duration-400"></span>
          <span class="block w-[26px] h-[3px] bg-black my-1 transition-transform duration-400"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    class="menu-overlay fixed inset-0 bg-black/60 opacity-0 invisible transition-all duration-400 z-9998"
    id="menuOverlay"
  ></div>

  <!-- Mobile Menu -->
  <div
    class="mobile-menu fixed top-0 -left-full w-4/5 max-w-[320px] h-screen bg-white z-9999 px-6 pt-20 pb-6 transition-all duration-400 ease-in-out overflow-y-auto"
    id="mobileMenu"
  >
    <ul class="list-none p-0 m-0">
      <li class="mb-5">
        <a
          href="/products/astra/pricing/"
          class="text-lg font-medium text-black no-underline"
        >
          Pricing
        </a>
      </li>
      <li class="mb-5">
        <a href="https://www.wati.io/">
          <img
            width="70"
            height="25"
            alt="Wati Logo"
            src="/images/wati-logo.png"
          />
        </a>
      </li>
      <li class="mb-5">
        <a
          href="#"
          id="astraBookDemoBtnMobile"
          class="text-lg font-medium text-black no-underline"
        >
          Book a demo
        </a>
      </li>
      <li class="mb-5">
        <a
          href="https://astra.wati.io/register/"
          target="_blank"
          rel="noopener"
          class="text-lg font-medium text-black no-underline"
        >
          Get started for free
        </a>
      </li>
      <li class="mb-5">
        <a
          href="https://astra.wati.io/register/"
          target="_blank"
          rel="noopener"
          class="text-lg font-medium text-black no-underline"
        >
          Login / Sign up
        </a>
      </li>
    </ul>
  </div>
</header>

<style>
  /* Fixed header */
  #masthead {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    width: 100%;
    z-index: 100;
    transition: background-color 0.3s ease;
  }

  /* Scrolled state */
  #masthead.scrolled {
    background: #fff;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* Hamburger active state */
  .hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }

  .hamburger.active span:nth-child(2) {
    opacity: 0;
  }

  .hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  /* Mobile menu active states */
  .menu-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .mobile-menu.active {
    left: 0;
    box-shadow: 0 0 10px rgba(67, 66, 66, 0.37);
  }

  /* CTA Buttons positioning - consistent width */
  .header-cta-btn {
    position: relative;
    padding-right: 28px !important; /* Always reserve space for arrow */
  }

  /* CTA Button hover effect - show arrow */
  .header-cta-btn:hover::after {
    content: '';
    background: url('/images/arrow-white.svg') no-repeat center;
    background-size: contain;
    width: 16px !important;
    height: 16px !important;
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
  }

  /* Mobile specific */
  @media only screen and (max-width: 767px) {
    #masthead {
      background: #fff !important;
    }

    .mobile-menu.active {
      left: 0;
      box-shadow: 0 0 10px rgba(67, 66, 66, 0.37);
    }
  }

  /* Hide pricing link on pricing page */
  .page-template-tpl-astrapricing .astra-pricing-menu-link {
    display: none;
  }
</style>

<script>
  // Scroll effect
  const header = document.getElementById('masthead');

  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
  });

  // Mobile menu toggle
  const mobileMenuToggle = document.getElementById('mobileMenuToggle');
  const mobileMenu = document.getElementById('mobileMenu');
  const menuOverlay = document.getElementById('menuOverlay');

  function toggleMobileMenu() {
    mobileMenuToggle?.classList.toggle('active');
    mobileMenu?.classList.toggle('active');
    menuOverlay?.classList.toggle('active');
    document.body.style.overflow = mobileMenu?.classList.contains('active') ? 'hidden' : '';
  }

  mobileMenuToggle?.addEventListener('click', toggleMobileMenu);
  menuOverlay?.addEventListener('click', toggleMobileMenu);

  // Close menu when clicking a link
  const mobileMenuLinks = mobileMenu?.querySelectorAll('a');
  mobileMenuLinks?.forEach(link => {
    link.addEventListener('click', () => {
      if (!link.getAttribute('href')?.startsWith('#')) {
        toggleMobileMenu();
      }
    });
  });

  // Book demo buttons
  const bookDemoButtons = ['astraBookDemoBtn', 'astraBookDemoBtnMobile'];
  bookDemoButtons.forEach(btnId => {
    const btn = document.getElementById(btnId);
    btn?.addEventListener('click', (e) => {
      e.preventDefault();
      // Trigger modal (handled in astra.astro)
      const event = new CustomEvent('openBookDemoModal');
      window.dispatchEvent(event);

      // Close mobile menu if open
      if (mobileMenu?.classList.contains('active')) {
        toggleMobileMenu();
      }
    });
  });
</script>
